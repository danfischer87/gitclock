<!DOCTYPE html>
<html>
  <head>
    <title>Git Clock</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript">
      window.onload = function () {
        canvas = document.getElementById('canvas');
        ctx = canvas.getContext("2d");
        
        // // hard_coded
        // bottom_left_x  = 20;
        // bottom_left_y  = 2500;
        // spacing        = 15;
        // branch_spacing = 25;
        // dot_radius     = 5;
        
        // percentages
        bottom_left_x  = .05;
        bottom_left_y  = 1;
        spacing        = .006;
        branch_spacing = .01;
        dot_radius     = .002;
        
        horizontal = false;
        
        SANGLE         = 0;
        EANGLE         = 2 * Math.PI;
        CLOCKWISE      = false;  
        
        function clear_whole_canvas() {
          ctx.clearRect(0, 0, 2500, 2500);
        }
        
        function resize_and_rotate() {
          canvas.height =  window.innerHeight;
          canvas.width = window.innerWidth;
          
          if(window.innerWidth > window.innerHeight) {
            // If it is wider than it is tall, display it horizontally
            max_width_or_height = window.innerWidth;
            
            if(horizontal == false) {
              ctx.translate(window.innerWidth, 0);
              ctx.rotate(90*Math.PI/180);
            }
            horizontal = true;
          }
          else {
            max_width_or_height = window.innerHeight;
            
            // if(horizontal == true) {
            //   ctx.translate(window.innerWidth, 0);
            //   ctx.rotate(-90*Math.PI/180);
            // }
            horizontal = false;
          }
        }
        resize_and_rotate();
        
        function adjusted_bottom_left_x() {
          return (bottom_left_x * max_width_or_height);
        }
        
        function adjusted_bottom_left_y() {
          return (bottom_left_y * max_width_or_height);
        }
        
        function adjusted_spacing() {
          return (spacing * max_width_or_height);
        }
        
        function adjusted_branch_spacing() {
          return (branch_spacing * max_width_or_height);
        }
        
        function adjusted_dot_radius() {
          return (dot_radius * max_width_or_height);
        }
        
        function update_clock(){
          clear_whole_canvas();
          // resize_and_rotate();
          
          var current_time = new Date();

          var current_hours = current_time.getHours();
          if(current_hours == 0) {
            current_hours == 24;
          }
          var current_minutes = current_time.getMinutes();
          var current_seconds = current_time.getSeconds();
          
          // var current_hours = 24;
          // var current_minutes = 59;
          // var current_seconds = 59;

          draw_time_for(1, 24, current_hours, 0);
          draw_time_for(2, 59, current_minutes, current_hours);
          draw_time_for(3, 59, current_seconds, current_minutes + current_hours);
          
          add_current_time_label(4, current_minutes + current_hours + current_seconds + 1);
          add_all_other_labels(current_hours, current_minutes, current_seconds);
        }
        
        function add_current_time_label(column, row) {
          var coordinates = position(column, row);
          
          ctx.fillStyle = "Red";
          ctx.font = "12pt Calibri";
          ctx.textBaseline = 'middle';
          ctx.textAlign = "left";
          ctx.fillText("current_time", coordinates[0]-(.006 * max_width_or_height), coordinates[1]);
          ctx.fillStyle = "Black";
        }
        
        function add_all_other_labels(current_hours, current_minutes, current_seconds){
          var coordinates = position(0, 25);
          
          ctx.fillStyle = "Gray";
          ctx.font = "12pt Calibri";
          ctx.textBaseline = "middle";
          ctx.textAlign = "right";
          ctx.fillText("hours", coordinates[0]+(.006 * max_width_or_height), coordinates[1]);
          
          var coordinates = position(1, current_hours + 60);
          
          ctx.font = "12pt Calibri";
          ctx.textBaseline = "middle";
          ctx.textAlign = "right";
          ctx.fillText("minutes", coordinates[0]+(.006 * max_width_or_height), coordinates[1]);
          
          var coordinates = position(2, current_hours + current_minutes + 60);
          
          ctx.font = "12pt Calibri";
          ctx.textBaseline = "middle";
          ctx.textAlign = "right";
          ctx.fillText("seconds", coordinates[0]+(.006 * max_width_or_height), coordinates[1]);
          
          ctx.fillStyle = "Black";
        }

        function draw_time_for(column, up_to, current_val, connected_to) {
          if(column == 0) {
            var starting_row = connected_to;
          }
          else {
            var starting_row = connected_to + 1;
          }


          for(i = 1; i <= up_to; i++) {
            if(i <= current_val){
              // Make solid color
              ctx.globalAlpha = 1;
            }
            else {
              // Make transparent
              ctx.globalAlpha = 0.3;
            }
            
            var coordinates = position(column, (i+starting_row));
            
            if((column == 1 && i==12) || (column > 1 && i%10 == 0)) {
               ctx.fillStyle = "Red";
            }
            else {
              ctx.fillStyle = "Black";
            }
           
            ctx.beginPath();
            ctx.arc(coordinates[0], coordinates[1], adjusted_dot_radius(), SANGLE, EANGLE, CLOCKWISE);
            ctx.closePath();
            ctx.fill();
            ctx.globalAlpha = 1;
            
            
            if(i == 1) {
              var is_bottom = true;
            }
            else {
              var is_bottom = false;
            }
            draw_line_to_parent(column, (i+starting_row), is_bottom);
          }
        }
        
        function position(column, row) {
          var coordinates = [];
          var x = adjusted_bottom_left_x() + (column*adjusted_branch_spacing());
          var y = adjusted_bottom_left_y() - (row*adjusted_spacing());
          
          coordinates = [x, y];
          
          return coordinates;
        }
        
        function draw_line_to_parent(column,row, is_bottom) {
          if(is_bottom == true) {
            var parent_column = column - 1;
          }
          else {
            var parent_column = column;
          }
          var parent_row = row - 1;
          
          var coordinates_start = position(column, row);
          var coordinates_end = position(parent_column, parent_row);
          
          
          ctx.strokeStyle = "Blue";
          
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(coordinates_start[0],coordinates_start[1]);
          ctx.lineTo(coordinates_end[0],coordinates_end[1]);
          ctx.stroke();
          ctx.strokeStyle = "Black";
        }
        
        setInterval(function(){update_clock()}, 1000);
      }
    </script>
  </head>
  <body>
    <h1>Git Inspired Clock</h1>
    
    <canvas id="canvas" width="2500" height="400"></canvas>
  </body>
</html>